<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Cloud Storage Example</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // Function to store a JSON string in cloud storage
        function storeJson() {
            const jsonString = '[{"on":60,"off":75},{"on":135,"off":150},{"on":180,"off":195},{"on":240,"off":255},{"on":300,"off":315},{"on":405,"off":420},{"on":450,"off":465},{"on":495,"off":510},{"on":540,"off":555},{"on":615,"off":630},{"on":690,"off":705},{"on":735,"off":750},{"on":810,"off":825},{"on":870,"off":885},{"on":960,"off":975},{"on":1020,"off":1035},{"on":1125,"off":1140},{"on":1170,"off":1185},{"on":1260,"off":1275},{"on":1305,"off":1320},{"on":1380,"off":1425}]';
            const key = 'user_data';

            Telegram.WebApp.CloudStorage.setItem(key, jsonString, (error, success) => {
                if (error) {
                    console.error('Error storing JSON string:', error);
                } else if (success) {
                    console.warn('JSON string stored successfully');
                }
            });
        }

        // Function to retrieve a JSON string from cloud storage
        function retrieveJson() {
            const key = 'user_data';

            Telegram.WebApp.CloudStorage.getItem(key, (error, value) => {
                if (error) {
                    console.error('Error retrieving JSON string:', error);
                } else {
                    console.warn('Retrieved JSON string:', value);
                }
            });
        }

        window.onload = () => {
            Telegram.WebApp.ready();
            retrieveJson();
            storeJson();
            retrieveJson();
        };
    </script>
</head>
<body>
    <h1>Telegram Cloud Storage Example</h1>
<!--
      <h1>Send Inline Message via Telegram Web App</h1>
    <button id="sendBtn">Send Message</button>
-->
    <script>
        document.getElementById('sendBtn').addEventListener('click', () => {
            // This assumes you have obtained the 'inline_message_id' in some way,
            // for example, after a user has interacted with a previous inline message sent by your bot.
            const inlineMessageId = 'obtained_inline_message_id'; // Placeholder, replace with actual ID

            // Define the inline keyboard layout
            const inlineKeyboard = [
                [{ text: "Option 1", callback_data: "option1" }],
                [{ text: "Option 2", callback_data: "option2" }]
            ];

            // Prepare the message content and the keyboard in the format required by Telegram API
            const messageData = {
                method: "editMessageText", // Assuming you're editing an existing inline message
                inline_message_id: inlineMessageId,
                text: "Choose an option:",
                reply_markup: JSON.stringify({ inline_keyboard: inlineKeyboard })
            };

            // Use Telegram Web App API to send the message
            Telegram.WebApp.sendData(JSON.stringify(messageData));
        });

        // Initialize the Web App
        Telegram.WebApp.ready();
    </script>
</body>
</html>
