
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram WebApp MiniApp Arduino ESP8266, Task Scheduler</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #2F3330;
            color: lightgray;
        }
        form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        input, button {
            padding: 10px;
            font-size: 12px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        button {
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .time-entry {
            display: flex;
            justify-content: center;
            gap: 10px;
            align-items: center;
        }
        label {
            font-size: 12px;
        }
        .time-label {
            margin-right: 2px;
        }
        pre {
            font-size: 8px;
        }
        a {
            color: orange;
        }
        a:hover {
            color: yellow;
        }
    </style>
</head>
<body>

    <a href="https://github.com/ldijkman/Universal-Arduino-Telegram-Bot" target="_blank">Forked Universal-Arduino-Telegram-Bot</a><br>
    <a href="https://t.me/Luberth_Dijkman/84" target="_blank">https://t.me/Luberth_Dijkman</a><br>
    <!--
    <h2>Schedule Daily Task</h2>
    <form id="taskForm">
        <input type="text" id="taskName" name="taskName" placeholder="Task Name" value="task 1" hidden>
    -->   
    <!-- Dynamically numbered tasks will be inserted here -->
    <!--
        <button type="submit">Submit Task</button>
    </form>
    <br><br>
    <button id="sendMenu">Send /menu</button>
-->
    <!-- Additional fields for sending and receiving data -->
    <div>
        <label for="dataToSend">Data to Send:</label>
        <input type="text" id="dataToSend" placeholder="Enter data here">
        <button id="sendDataBtn">Send Data</button>
    </div>
    <div>
        <label for="receivedData">Received Data:</label>
        <pre id="receivedData">No data received yet.</pre>
    </div>
    <button id="receiveDataBtn">Receive Data</button>

    <script>
        function addTimeEntry(taskNumber) {
            const storedOnTime = localStorage.getItem(`taskTime${taskNumber}_on`);
            const storedOffTime = localStorage.getItem(`taskTime${taskNumber}_off`);

            const defaultOnTime = storedOnTime || '08:00';
            const defaultOffTime = storedOffTime || '18:00';

            const timeEntryDiv = document.createElement('div');
            timeEntryDiv.className = 'time-entry';
            timeEntryDiv.innerHTML = `
                <label for="taskTime${taskNumber}_on" class="time-label">On:</label>
                <input type="time" id="taskTime${taskNumber}_on" name="taskTime${taskNumber}_on" value="${defaultOnTime}">
                <label for="taskTime${taskNumber}_off" class="time-label">Off:</label>
                <input type="time" id="taskTime${taskNumber}_off" name="taskTime${taskNumber}_off" value="${defaultOffTime}">
            `;
            document.getElementById('taskForm').insertBefore(timeEntryDiv, document.getElementById('taskForm').lastChild);
        }

       // for (let i = 1; i <= 5; i++) {
       ///     addTimeEntry(i);
      //  }

        document.getElementById('taskForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const taskName = document.getElementById('taskName').value;
            const taskTimes = [];
            for (let i = 1; i <= 5; i++) {
                const onTime = document.getElementById(`taskTime${i}_on`).value;
                const offTime = document.getElementById(`taskTime${i}_off`).value;
                if (onTime && offTime) {
                    taskTimes.push({on: onTime, off: offTime});
                    localStorage.setItem(`taskTime${i}_on`, onTime);
                    localStorage.setItem(`taskTime${i}_off`, offTime);
                }
            }
            const data = {
                taskTimes: taskTimes
            };
            Telegram.WebApp.sendData(JSON.stringify(data));
            console.log("Data sent:", data);
        });

        document.getElementById('sendMenu').addEventListener('click', function() {
            Telegram.WebApp.sendData(JSON.stringify({command: '/menu'}));
        });

        document.getElementById('sendDataBtn').addEventListener('click', function() {
            const dataToSend = document.getElementById('dataToSend').value;
            Telegram.WebApp.sendData(dataToSend);
            console.log("Data sent to bot:", dataToSend);
            localStorage.setItem('sentData', dataToSend);
        });

        document.getElementById('receiveDataBtn').addEventListener('click', function() {
            const receivedData = localStorage.getItem('sentData') || 'No data received yet.';
            document.getElementById('receivedData').textContent = receivedData;
            console.log("Data received:", receivedData);
        });
    </script> 
</body>
</html>














<!--


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Cloud Storage Example</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // Function to store a JSON string in cloud storage
        function storeJson() {
            const jsonString = '[{"on":60,"off":75},{"on":135,"off":150},{"on":180,"off":195},{"on":240,"off":255},{"on":300,"off":315},{"on":405,"off":420},{"on":450,"off":465},{"on":495,"off":510},{"on":540,"off":555},{"on":615,"off":630},{"on":690,"off":705},{"on":735,"off":750},{"on":810,"off":825},{"on":870,"off":885},{"on":960,"off":975},{"on":1020,"off":1035},{"on":1125,"off":1140},{"on":1170,"off":1185},{"on":1260,"off":1275},{"on":1305,"off":1320},{"on":1380,"off":1425}]';
            const key = 'user_data';

            Telegram.WebApp.CloudStorage.setItem(key, jsonString, (error, success) => {
                if (error) {
                    console.error('Error storing JSON string:', error);
                } else if (success) {
                    console.warn('JSON string stored successfully');
                }
            });
        }

        // Function to retrieve a JSON string from cloud storage
        function retrieveJson() {
            const key = 'user_data';

            Telegram.WebApp.CloudStorage.getItem(key, (error, value) => {
                if (error) {
                    console.error('Error retrieving JSON string:', error);
                } else {
                    console.warn('Retrieved JSON string:', value);
                }
            });
        }

        window.onload = () => {
            Telegram.WebApp.ready();
            retrieveJson();
            storeJson();
            retrieveJson();
        };
    </script>
</head>
<body>
    <h1>Telegram Cloud Storage Example</h1>

      <h1>Send Inline Message via Telegram Web App</h1>
    <button id="sendBtn">Send Message</button>

    <script>
        document.getElementById('sendBtn').addEventListener('click', () => {
            // This assumes you have obtained the 'inline_message_id' in some way,
            // for example, after a user has interacted with a previous inline message sent by your bot.
            const inlineMessageId = 'obtained_inline_message_id'; // Placeholder, replace with actual ID

            // Define the inline keyboard layout
            const inlineKeyboard = [
                [{ text: "Option 1", callback_data: "option1" }],
                [{ text: "Option 2", callback_data: "option2" }]
            ];

            // Prepare the message content and the keyboard in the format required by Telegram API
            const messageData = {
                method: "editMessageText", // Assuming you're editing an existing inline message
                inline_message_id: inlineMessageId,
                text: "Choose an option:",
                reply_markup: JSON.stringify({ inline_keyboard: inlineKeyboard })
            };

            // Use Telegram Web App API to send the message
            Telegram.WebApp.sendData(JSON.stringify(messageData));
        });

        // Initialize the Web App
        Telegram.WebApp.ready();
    </script>
</body>
</html>
