note default relais is on D1 wich is i2c



<div class="flex gap-2 py-2.5 flex-row"><div class="text-xs text-[#6b7684] text-right"><div class="relative flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32"><g fill="none" fill-rule="evenodd"><path fill="#6436E2" d="M12 0c2.309 0 4.412.564 6.19 1.572a11.208 11.208 0 0 1 4.238 4.238C23.436 7.588 24 9.691 24 12c0 2.309-.564 4.412-1.572 6.19a11.208 11.208 0 0 1-4.238 4.238C16.412 23.436 14.309 24 12 24c-2.309 0-4.412-.564-6.19-1.572a11.208 11.208 0 0 1-4.238-4.238C.564 16.412 0 14.309 0 12c0-2.309.564-4.412 1.572-6.19A11.208 11.208 0 0 1 5.81 1.572C7.588.564 9.691 0 12 0z"></path><path fill="#FFF" d="M18.233 13.357a2.678 2.678 0 0 1-.55 1.406 2.733 2.733 0 0 1-1.23.896v-3.411a.46.46 0 0 0-.237-.408l-3.548-2.021 1.228-.7a.044.044 0 0 1 .041-.004l2.938 1.674c.45.257.817.634 1.058 1.09.24.454.344.967.3 1.478zm-2.735 2.203c-.001.715-.29 1.4-.802 1.906a2.757 2.757 0 0 1-3.682.168 2.14 2.14 0 0 0 .087-.048l2.906-1.656a.47.47 0 0 0 .238-.408V11.48l1.229.7a.044.044 0 0 1 .016.013.045.045 0 0 1 .008.02v3.347zM8.55 17.038a2.733 2.733 0 0 1-1.661-1.256 2.659 2.659 0 0 1-.326-1.808l.086.05 2.906 1.657a.478.478 0 0 0 .477 0l3.548-2.021v1.4a.043.043 0 0 1-.018.036l-2.937 1.674a2.77 2.77 0 0 1-2.075.268zM5.853 11.57a2.67 2.67 0 0 1 .272-2.047A2.716 2.716 0 0 1 7.548 8.34l-.001.099v3.312a.461.461 0 0 0 .238.408l3.548 2.02-1.228.7a.045.045 0 0 1-.042.004l-2.938-1.675a2.706 2.706 0 0 1-1.272-1.638zm2.648-3.131c0-.513.148-1.015.427-1.448a2.724 2.724 0 0 1 1.148-.995 2.769 2.769 0 0 1 2.91.37 2.18 2.18 0 0 0-.086.049L9.994 8.07a.47.47 0 0 0-.239.407l-.002 4.041-1.228-.7a.043.043 0 0 1-.024-.033V8.44zm3.5 1.76 1.58.9v1.8l-1.58.9-1.58-.9v-1.8l1.58-.9zm2.859-3.327a2.76 2.76 0 0 1 1.447.482c.426.293.759.7.959 1.173.2.473.26.992.172 1.498a3.618 3.618 0 0 0-.086-.051l-2.906-1.656a.478.478 0 0 0-.477 0l-3.548 2.02V8.94c0-.007 0-.014.004-.02a.043.043 0 0 1 .014-.017l2.937-1.672c.45-.256.965-.38 1.484-.358zm4.32 5.875a3.607 3.607 0 0 0-.93-2.054 3.543 3.543 0 0 0-.312-2.946 3.66 3.66 0 0 0-1.692-1.508 3.723 3.723 0 0 0-2.268-.233 3.633 3.633 0 0 0-1.24-.895 3.679 3.679 0 0 0-1.502-.31 3.712 3.712 0 0 0-2.17.691 3.631 3.631 0 0 0-1.338 1.82c-.507.103-.987.31-1.406.611-.42.3-.769.685-1.025 1.13a3.589 3.589 0 0 0 .452 4.254 3.544 3.544 0 0 0 .313 2.946 3.66 3.66 0 0 0 1.692 1.507 3.723 3.723 0 0 0 2.268.234c.344.382.766.687 1.239.895a3.68 3.68 0 0 0 1.503.31c.78.003 1.54-.24 2.17-.691a3.63 3.63 0 0 0 1.339-1.822c.507-.102.987-.31 1.406-.61.42-.3.769-.686 1.025-1.13.39-.665.557-1.435.476-2.2z"></path></g></svg></div></div><div class="max-w-[85%] px-3 break-words text-[#191f28] leading-6 rounded-xl py-2.5 mr-auto rounded-tl-md bg-white"><div class="prose max-w-[100%] break-words"><p>To adapt the existing code from using a DS18B20 temperature sensor to a BME280 sensor for temperature, humidity, and pressure measurements, we need to make several changes. This includes modifying the library imports, initializing the BME280 sensor, reading the data from the BME280, and adjusting any references to the temperature reading process in the code.</p>
<p>The BME280 sensor is typically interfaced via I2C, so the first step is to identify the I2C pins on your ESP8266 board and connect the BME280 accordingly. The ESP8266's default I2C pins are usually GPIO4 (D2) for SDA (data line) and GPIO5 (D1) for SCL (clock line), but you can use other pins by specifying them in your code if necessary.</p>
<p>Here's how to adapt the code for a BME280 sensor:</p>
<h3>1. Include Required Libraries</h3>
<p>You'll need the Adafruit BME280 library and its dependencies, which can be installed via the Arduino Library Manager:</p>
<ul>
<li>Adafruit BME280 Library</li>
<li>Adafruit Unified Sensor Library</li>
</ul>
<p>Add these includes at the top of your sketch:</p>
<pre class="scrollbar-thin scrollbar-thumb-[#33435a] scrollbar-track-[#1f2937]"><div style="color: rgb(248, 248, 242); background: rgb(43, 43, 43); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code class="language-cpp" style="color: rgb(248, 248, 242); background: none; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span class="token macro directive-hash" style="color: rgb(255, 160, 122);">#</span><span class="token macro directive" style="color: rgb(0, 224, 224);">include</span><span class="token macro" style="color: rgb(255, 160, 122);"> </span><span class="token macro" style="color: rgb(171, 227, 56);">&lt;Wire.h&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color: rgb(255, 160, 122);">#</span><span class="token macro directive" style="color: rgb(0, 224, 224);">include</span><span class="token macro" style="color: rgb(255, 160, 122);"> </span><span class="token macro" style="color: rgb(171, 227, 56);">&lt;Adafruit_Sensor.h&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color: rgb(255, 160, 122);">#</span><span class="token macro directive" style="color: rgb(0, 224, 224);">include</span><span class="token macro" style="color: rgb(255, 160, 122);"> </span><span class="token macro" style="color: rgb(171, 227, 56);">&lt;Adafruit_BME280.h&gt;</span></code></div></pre>
<h3>2. Initialize BME280 Sensor</h3>
<p>Declare a global instance of the BME280 sensor and specify the I2C address. The BME280 can have an I2C address of either 0x76 or 0x77 (the default), depending on how its <code>SDO</code> pin is connected.</p>
<pre class="scrollbar-thin scrollbar-thumb-[#33435a] scrollbar-track-[#1f2937]"><div style="color: rgb(248, 248, 242); background: rgb(43, 43, 43); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code class="language-cpp" style="color: rgb(248, 248, 242); background: none; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span>Adafruit_BME280 bme</span><span class="token" style="color: rgb(254, 254, 254);">;</span><span> </span><span class="token" style="color: rgb(212, 208, 171);">// Use default I2C address 0x77</span><span>
</span><span></span><span class="token" style="color: rgb(212, 208, 171);">// If your device uses the alternative address, use: Adafruit_BME280 bme(BME280_ADDRESS_ALTERNATE);</span></code></div></pre>
<p>Within the <code>setup()</code> function, initialize the BME280 sensor:</p>
<pre class="scrollbar-thin scrollbar-thumb-[#33435a] scrollbar-track-[#1f2937]"><div style="color: rgb(248, 248, 242); background: rgb(43, 43, 43); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code class="language-cpp" style="color: rgb(248, 248, 242); background: none; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span class="token" style="color: rgb(0, 224, 224);">void</span><span> </span><span class="token" style="color: rgb(255, 215, 0);">setup</span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span> </span><span class="token" style="color: rgb(254, 254, 254);">{</span><span>
</span><span>  Serial</span><span class="token" style="color: rgb(254, 254, 254);">.</span><span class="token" style="color: rgb(255, 215, 0);">begin</span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(0, 224, 224);">115200</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span class="token" style="color: rgb(254, 254, 254);">;</span><span>
</span><span>  </span><span class="token" style="color: rgb(212, 208, 171);">// Other setup code...</span><span>
</span>
<span>  </span><span class="token" style="color: rgb(0, 224, 224);">if</span><span> </span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(0, 224, 224);">!</span><span>bme</span><span class="token" style="color: rgb(254, 254, 254);">.</span><span class="token" style="color: rgb(255, 215, 0);">begin</span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span> </span><span class="token" style="color: rgb(254, 254, 254);">{</span><span>
</span><span>    Serial</span><span class="token" style="color: rgb(254, 254, 254);">.</span><span class="token" style="color: rgb(255, 215, 0);">println</span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(255, 215, 0);">F</span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(171, 227, 56);">"Could not find a valid BME280 sensor, check wiring!"</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span class="token" style="color: rgb(254, 254, 254);">;</span><span>
</span><span>    </span><span class="token" style="color: rgb(0, 224, 224);">while</span><span> </span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(0, 224, 224);">1</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span class="token" style="color: rgb(254, 254, 254);">;</span><span>
</span><span>  </span><span class="token" style="color: rgb(254, 254, 254);">}</span><span>
</span>
<span>  </span><span class="token" style="color: rgb(212, 208, 171);">// Other setup tasks...</span><span>
</span><span></span><span class="token" style="color: rgb(254, 254, 254);">}</span></code></div></pre>
<h3>3. Reading Data from BME280</h3>
<p>In the part of your code where you previously read the temperature from the DS18B20, replace it with code to read from the BME280. The BME280 can provide temperature, humidity, and atmospheric pressure readings.</p>
<pre class="scrollbar-thin scrollbar-thumb-[#33435a] scrollbar-track-[#1f2937]"><div style="color: rgb(248, 248, 242); background: rgb(43, 43, 43); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code class="language-cpp" style="color: rgb(248, 248, 242); background: none; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span class="token" style="color: rgb(0, 224, 224);">void</span><span> </span><span class="token" style="color: rgb(255, 215, 0);">loop</span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span> </span><span class="token" style="color: rgb(254, 254, 254);">{</span><span>
</span><span>  </span><span class="token" style="color: rgb(212, 208, 171);">// Other loop code...</span><span>
</span>
<span>  </span><span class="token" style="color: rgb(0, 224, 224);">float</span><span> temperature </span><span class="token" style="color: rgb(0, 224, 224);">=</span><span> bme</span><span class="token" style="color: rgb(254, 254, 254);">.</span><span class="token" style="color: rgb(255, 215, 0);">readTemperature</span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span class="token" style="color: rgb(254, 254, 254);">;</span><span>
</span><span>  </span><span class="token" style="color: rgb(0, 224, 224);">float</span><span> humidity </span><span class="token" style="color: rgb(0, 224, 224);">=</span><span> bme</span><span class="token" style="color: rgb(254, 254, 254);">.</span><span class="token" style="color: rgb(255, 215, 0);">readHumidity</span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span class="token" style="color: rgb(254, 254, 254);">;</span><span>
</span><span>  </span><span class="token" style="color: rgb(0, 224, 224);">float</span><span> pressure </span><span class="token" style="color: rgb(0, 224, 224);">=</span><span> bme</span><span class="token" style="color: rgb(254, 254, 254);">.</span><span class="token" style="color: rgb(255, 215, 0);">readPressure</span><span class="token" style="color: rgb(254, 254, 254);">(</span><span class="token" style="color: rgb(254, 254, 254);">)</span><span> </span><span class="token" style="color: rgb(0, 224, 224);">/</span><span> </span><span class="token" style="color: rgb(0, 224, 224);">100.0F</span><span class="token" style="color: rgb(254, 254, 254);">;</span><span> </span><span class="token" style="color: rgb(212, 208, 171);">// Convert from Pa to hPa</span><span>
</span>
<span>  </span><span class="token" style="color: rgb(212, 208, 171);">// Use these values as needed in your application</span><span>
</span>
<span>  </span><span class="token" style="color: rgb(212, 208, 171);">// Other loop tasks...</span><span>
</span><span></span><span class="token" style="color: rgb(254, 254, 254);">}</span></code></div></pre>
<h3>4. Adjust Any References</h3>
<p>Make sure to adjust any other parts of your code that reference the DS18B20 sensor, including variable names and logic related to temperature measurements.</p>
<h3>5. Additional Considerations</h3>
<ul>
<li>The BME280 provides more data than the DS18B20 (which only measures temperature), so consider how you might use the additional humidity and pressure information in your project.</li>
<li>Since you're switching from a one-wire device to an I2C device, make sure the rest of your I2C bus (if used) is compatible with the addition of the BME280 sensor.</li>
<li>You might need to adjust the timing or logic in your code based on how often you read from the BME280, as reading all three measurements (temperature, humidity, pressure) might take slightly longer than reading only the temperature from the DS18B20.</li>
</ul>
<p>By following these steps, you should be able to successfully adapt your existing code to use a BME280 sensor instead of a DS18B20.</p></div></div></div>
